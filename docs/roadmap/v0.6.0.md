# Summon v0.6.0 - Multi-Platform Foundation

**Focus**: Essential UI/UX primitives needed for mobile/desktop support.
**Goal**: Establish the core interaction and layout models that abstract away platform differences.

## 1. Gesture System
**Requirement**: Implement a unified gesture detection system that works seamlessly across mouse, touch, and pen inputs.
**Technical Specs**:
- **Tap**: Detect single click or tap events. Must handle touch emulation on web to avoid 300ms delay. Maps to `onClick` on web and `clickable` modifier on Android.
- **Long Press**: Detect press-and-hold interactions. Configurable duration threshold. Maps to `onContextMenu` or custom timer on web.
- **Double Tap**: Detect two rapid taps within a time threshold.
- **Swipe**: Detect fling gestures with velocity and direction (Left, Right, Up, Down).
- **Pinch**: Detect two-finger pinch gestures for zooming. Must provide scale factor and focal point.
- **Drag**: Detect drag gestures with delta offsets. distinct from HTML5 Drag & Drop.
- **Rotate**: Detect two-finger rotation gestures. Must provide rotation angle.

## 2. Platform-Agnostic Layout Primitives
**Requirement**: Provide high-level application structure components that adapt to the platform.
**Technical Specs**:
- **Scaffold**: The root layout structure. Slots for TopBar, BottomBar, FAB, Drawer, and Content. Handles safe area insets automatically.
- **TopAppBar**: Standard header. Slots for navigation icon, title, and actions.
- **BottomNavigation**: Tab bar for mobile/narrow layouts.
- **NavigationDrawer**: Side menu. Supports Modal (overlay) and Permanent (side-by-side) modes.
- **BottomSheet**: Slide-up panel. Supports Modal (overlay) and Standard (persistent) modes.
- **FloatingActionButton**: Primary action button. Supports standard and extended (text + icon) variants.
- **Snackbar**: Temporary notification toast. Must support queueing and action buttons.
- **NavigationRail**: Vertical side navigation for tablet/desktop.
- **SplitPane**: Resizable two-pane layout for desktop.
- **Sidebar**: Collapsible side panel for desktop apps.

## 3. Window Insets / Safe Areas
**Requirement**: Abstract system UI obstructions (notches, status bars, software keyboards).
**Technical Specs**:
- **Safe Area Padding**: Modifier to apply padding matching the system safe area.
- **Window Insets**: Low-level API to query specific insets (status bar, navigation bar, IME/keyboard).
- **Consumption**: Mechanism to consume insets so nested components don't double-pad.

## 4. Navigation with Back Stack
**Requirement**: A platform-agnostic routing system with history management.
**Technical Specs**:
- **Stack Management**: Push, pop, and replace operations.
- **PopUpTo**: Ability to pop multiple screens off the stack until a specific destination.
- **Type Safety**: Routes should be defined as typed objects/classes, not just strings.
- **Deep Linking**: Map URLs to specific stack states.

## 5. Semantic Accessibility
**Requirement**: A unified accessibility tree that maps to platform-specific APIs.
**Technical Specs**:
- **Semantics Modifier**: Allows attaching metadata to any component.
- **Roles**: Define component roles (Button, Checkbox, Tab, Heading, etc.).
- **Actions**: Define supported actions (Click, Scroll, Dismiss).
- **Properties**: State descriptions (Selected, Disabled, Expanded).
- **Mapping**:
    - Web: ARIA attributes (`role`, `aria-label`, `aria-expanded`).
    - Android: `AccessibilityNodeInfo`.
    - iOS: `UIAccessibility`.

## 6. Focus and Keyboard Navigation
**Requirement**: Manage input focus and keyboard interactions programmatically.
**Technical Specs**:
- **Focus Requester**: Object to request focus on a specific component programmatically.
- **Focus Order**: API to define custom tab traversal order (Next, Previous, Up, Down).
- **Key Events**: Intercept hardware keyboard events (KeyDown, KeyUp).
- **Shortcuts**: Define keyboard shortcuts (e.g., Ctrl+S) that trigger actions.

## 7. Clipboard API
**Requirement**: Read and write to the system clipboard.
**Technical Specs**:
- **Text**: Get and set plain text.
- **Async**: Operations must be suspend functions to handle platform permissions and IO.

## 8. Cursor Styles
**Requirement**: Change the mouse cursor appearance on hover.
**Technical Specs**:
- **Types**: Pointer, Text, Move, Resize (NS, EW, Diagonal), Grab, Grabbing, NotAllowed, Wait, Crosshair.
- **Custom**: Support for custom image cursors with hotspot coordinates.

## 9. Tooltip API
**Requirement**: Show informational text on hover or long-press.
**Technical Specs**:
- **Positioning**: Automatic positioning (Top, Bottom, Start, End) relative to the anchor.
- **Delay**: Configurable delay before showing.
- **Platform Behavior**: Hover on desktop, long-press on mobile.

## 10. Context Menu
**Requirement**: Display a menu of actions on right-click or long-press.
**Technical Specs**:
- **Area**: A container that defines the context menu items for its content.
- **Items**: Text labels, icons, and callbacks.
- **Nesting**: Support for submenus.

## 11. Drag and Drop (Enhanced)
**Requirement**: A cross-platform drag and drop abstraction.
**Technical Specs**:
- **Draggable**: Modifier to make an element a drag source.
- **DropTarget**: Modifier to make an element a drop zone.
- **Feedback**: Visual feedback during drag (ghost image).

## 12. DataTransfer Enhancement
**Requirement**: Support rich data types in drag and drop and clipboard operations.
**Technical Specs**:
- **Types**: Plain text, HTML, File lists, and custom internal application data.
- **Serialization**: Mechanism to serialize custom objects for transfer.

## 13. WASI Export Surface
**Requirement**: Enable Summon to compile to `wasm32-wasi` for headless/embedded environments.
**Technical Specs**:
- **Target**: Compile to `wasm32-wasi` target for platform-agnostic WebAssembly execution.
- **Entry Symbol**: Export `summon_entry()` function that returns a pointer to a serialized UI tree.
- **Event Symbol**: Export `summon_event()` function to handle input events from the host environment.
- **Memory Management**: Define clear ownership semantics for allocated UI tree memory.

## 14. CBOR UI Tree
**Requirement**: Provide a serializable, platform-agnostic UI tree representation.
**Technical Specs**:
- **Serialization**: UI tree serialized as CBOR (Concise Binary Object Representation) for compact transfer.
- **Structure**: Define `UiTree` data class hierarchy that captures component tree without DOM dependencies.
- **Diffing**: Support efficient tree diffing for incremental updates.
- **Interop**: Enable external renderers to consume and render the UI tree.

## 15. Theme DSL
**Requirement**: Compile-time styling definitions with type-safe theming.
**Technical Specs**:
- **Definition**: DSL for defining theme tokens (colors, typography, spacing) at compile time.
- **Variants**: Support light/dark themes and custom color schemes.
- **Type Safety**: Compile-time validation of theme references.
- **Extraction**: Support extracting theme definitions for external consumption.

## 16. Modifier Companion Object Pattern
**Requirement**: Refactor `Modifier` to use Jetpack Compose's companion object pattern for API familiarity.
**Technical Specs**:
- **Interface**: Convert `Modifier` from a data class to an interface with a companion object that implements it.
- **Empty Modifier**: The companion object serves as the empty/identity modifier, enabling `Modifier.padding()` syntax instead of `Modifier().padding()`.
- **Chaining**: Support `then` infix function for combining modifiers.
- **Implementation**: Internal `ModifierImpl` data class handles actual modifier state.
- **JS Compatibility**: Ensure proper export behavior for JavaScript targets (may require top-level val/function).
